#!/usr/bin/env ruby

lib = File.expand_path('../../lib', __FILE__)
$LOAD_PATH.unshift(lib) unless $LOAD_PATH.include?(lib)

require 'logger'
require 'percheron'
require 'percheron/cli'

$metastore = Metastore::Cabinet.new(File.join(ENV['HOME'], '.percheron', 'metastore.yaml'))
$logger = Logger.new(STDOUT)

logger_level = Logger::WARN

if ENV['VERBOSE'] == 'true'
  logger_level = Logger::INFO
end

if ENV['DEBUG'] == 'true' || ENV['DOCKER_DEBUG'] == 'true'
  require 'pry-byebug'
  require 'awesome_print'
  logger_level = Logger::DEBUG

  Docker.logger = $logger if ENV['DOCKER_DEBUG'] == 'true'
end

$logger.level = logger_level

Percheron::CLI::MainCommand.run
